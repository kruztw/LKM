ifneq	($(KERNELRELEASE),)
obj-m	:= simple.o

else
KDIR	:= /lib/modules/$(shell uname -r)/build
PWD	:= $(shell pwd)

all:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules
	rm -r -f .tmp_versions .*.cmd *.o *.symvers modules* *.mod* 

test: load
	dmesg --clear
	echo "a" > /dev/my_misc
	dmesg 
	rmmod simple

load:
	insmod ./simple.ko
unload:
	-rmmod simple
	-rm /dev/my_misc

endif

